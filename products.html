<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gourmet Jeju - 스마트 간편 견적</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.1/dist/cdn.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script src="js/data_dairy.js"></script>
    <script src="js/data_grocery.js"></script>
    <script src="js/data_meat.js"></script>
    <script src="js/data_dessert.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Pretendard', 'sans-serif'] },
                    colors: { 'brand-navy': '#0f172a', 'brand-gold': '#d4af37', 'brand-orange': '#ea580c', 'brand-light': '#f8fafc' }
                }
            }
        }
    </script>
</head>
<body class="bg-brand-light text-slate-800 antialiased pb-24 md:pb-0" x-data="app()">

    <header class="fixed w-full z-50 bg-white/95 backdrop-blur-md shadow-sm py-3">
        <nav class="container mx-auto px-4 flex justify-between items-center">
            <a href="index.html" class="text-xl font-bold text-brand-navy">Gourmet Jeju</a>
            <div class="flex items-center gap-4">
                <a href="index.html" class="text-sm font-bold text-slate-500 hover:text-brand-navy">홈으로</a>
                <button @click="openCartModal = true" class="bg-brand-navy text-white px-4 py-2 rounded-full text-sm font-bold relative">
                    <i class="fa-solid fa-clipboard-list mr-1"></i> 견적함
                    <span x-show="cart.length > 0" class="absolute -top-1 -right-1 bg-brand-orange w-5 h-5 rounded-full text-[10px] flex items-center justify-center" x-text="cart.length"></span>
                </button>
            </div>
        </nav>
    </header>

    <main class="pt-24 container mx-auto px-4 md:px-6">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-extrabold text-brand-navy mb-2">Product Catalog</h1>
            <div class="relative max-w-lg mx-auto mt-6">
                <input type="text" x-model="searchQuery" placeholder="상품명, 브랜드 검색..." class="w-full pl-12 pr-4 py-3 rounded-2xl border border-slate-200 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-navy">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-8 items-start">
            <aside class="hidden lg:block w-64 shrink-0 sticky top-24 space-y-6">
                <div>
                    <h3 class="font-bold text-brand-navy mb-3">카테고리</h3>
                    <ul class="space-y-1 text-sm">
                        <template x-for="cat in categories" :key="cat.id">
                            <li>
                                <button @click="filterCategory = cat.id" :class="filterCategory === cat.id ? 'text-brand-orange font-bold bg-orange-50' : 'text-slate-600 hover:bg-slate-100'" class="w-full text-left px-3 py-2 rounded-lg transition-colors flex justify-between">
                                    <span x-text="cat.name"></span>
                                    <span class="text-xs text-slate-400" x-text="getProductCount(cat.id)"></span>
                                </button>
                            </li>
                        </template>
                    </ul>
                </div>
            </aside>

            <div class="lg:hidden w-full overflow-x-auto pb-2 flex gap-2 no-scrollbar">
                <template x-for="cat in categories" :key="cat.id">
                    <button @click="filterCategory = cat.id" :class="filterCategory === cat.id ? 'bg-brand-navy text-white' : 'bg-white text-slate-600 border border-slate-200'" class="whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold" x-text="cat.name"></button>
                </template>
            </div>

            <div class="flex-1 w-full">
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 md:gap-6 mb-20">
                    <template x-for="product in filteredProducts" :key="product.id">
                        <div class="bg-white rounded-2xl border border-slate-100 overflow-hidden hover:shadow-lg transition-all group flex flex-col relative">
                            <div class="absolute top-3 left-3 z-10"><span x-show="product.tag" class="bg-brand-orange text-white text-[9px] font-bold px-2 py-0.5 rounded-full" x-text="product.tag"></span></div>
                            <div class="relative h-40 bg-slate-50 p-4 flex items-center justify-center">
                                <img :src="product.image" class="max-w-full max-h-full object-contain group-hover:scale-110 transition-transform" onerror="this.src='https://via.placeholder.com/150?text=No+Image'">
                            </div>
                            <div class="p-4 flex flex-col flex-grow">
                                <div class="text-[10px] text-slate-400 font-bold uppercase mb-1" x-text="product.brand"></div>
                                <h3 class="font-bold text-slate-800 text-sm mb-1 line-clamp-2" x-text="product.name"></h3>
                                <p class="text-xs text-slate-500 mb-3" x-text="product.spec"></p>
                                <div class="mt-auto pt-3 border-t border-slate-50">
                                    <button @click="addToCart(product)" :disabled="isInCart(product)" :class="isInCart(product) ? 'bg-slate-100 text-slate-400' : 'bg-brand-navy text-white hover:bg-brand-orange'" class="w-full py-2 rounded-xl text-xs font-bold transition-colors">
                                        <span x-text="isInCart(product) ? '담기 완료' : '견적함 담기'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
                <div x-show="filteredProducts.length === 0" class="text-center py-20 text-slate-400">상품이 없습니다.</div>
            </div>
        </div>
    </main>

    <script>
        function app() {
            return {
                // State
                openCartModal: false,
                searchQuery: '',
                filterCategory: 'all',
                cart: [],
                userInfo: { company: '', contact: '', memo: '' },
                
                categories: [
                    { id: 'all', name: '전체 보기' },
                    { id: 'dairy', name: '유제품 (치즈/버터)' },
                    { id: 'grocery', name: '가공식품 (파스타/오일)' },
                    { id: 'meat', name: '샤퀴테리/육가공' },
                    { id: 'dessert', name: '디저트/베이커리' }
                ],

                // [핵심] 모든 데이터 파일 병합
                products: [
                    ...(typeof dairyData !== 'undefined' ? dairyData : []),
                    ...(typeof groceryData !== 'undefined' ? groceryData : []),
                    ...(typeof meatData !== 'undefined' ? meatData : []),
                    ...(typeof dessertData !== 'undefined' ? dessertData : [])
                ],

                get filteredProducts() {
                    return this.products.filter(p => {
                        const matchSearch = p.name.toLowerCase().includes(this.searchQuery.toLowerCase()) || 
                                          p.brand.toLowerCase().includes(this.searchQuery.toLowerCase());
                        const matchCat = this.filterCategory === 'all' || p.category === this.filterCategory;
                        return matchSearch && matchCat;
                    });
                },

                getProductCount(catId) {
                    if (catId === 'all') return this.products.length;
                    return this.products.filter(p => p.category === catId).length;
                },
                
                addToCart(product) { if (!this.isInCart(product)) this.cart.push(product); },
                isInCart(product) { return this.cart.some(item => item.id === product.id); },
                // ... 기타 메소드 생략 (기존과 동일)
            }
        }
    </script>
</body>
</html>